{
  "hash": "0402009bc1c020d9585006f8903a1b47",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prerequisites\"\nformat: html\n---\n\n\n\n\n# Intro\n\nFor the workshop we will be using R. To be able to participate properly, it is advisable to install a number of packages on your own PC beforehand, as well as to become familiar with the way I usually code in R. This document is a brief guide to help you prepare.\n\n# Necessary Software & Packages\n\n## CmdStan & CmdStanR\n\nBayesian estimation and analyses require some dedicated samplers that should be installed on your machine. The workflow that we will cover in the workshop relies on `Stan` software. `Stan` stands alone from R but can be called through R making use of two different ways. We will cover this more in the workshop. \n\nFor the workshop I will use the `CmdStan` chain and the package `cmdstanr`. Therefore, I would encourage you to download and install a working `cmdstan` and `cmdstanr`. The following vignette can help you accomplish this: [https://mc-stan.org/cmdstanr/articles/cmdstanr.html](https://mc-stan.org/cmdstanr/articles/cmdstanr.html) \n\nNormally if you follow the steps described in that vignette you will succeed in installing and testing your installation. \n\n## `brms`\n\nFor the analyses we will rely on the amazing package `brms`. Installing this package is not that difficult, but maybe install before the workshop and start some exploring ;-)\n\n## `tidyverse`\n\nWhen I code I use the <b>functional programming </b> approach and a lot of the <b>tidy</b> principles (see below). The package `tidyverse` bundles a set of packages that are needed for this approach to coding. If you want to learn more on the whole universe of `tidyverse` you can explore the book of Hadley Wickham: [https://r4ds.had.co.nz/](https://r4ds.had.co.nz/)\n\n\n## `ggplot2`\n\nPart of the `tidyverse` package is the `ggplot2` package. Therefore it will be installed if you also install `tidyverse` normally. Nevertheless, I find it worth mentioning separately because I think knowing how to make graphs with `ggplot2` is very handy even if you do not dive into bayesian analyses. A great resource to learn to visualize your data is the tutorial written by Cédric Scherer: [https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/)!\n\nHe also blogs on creating great visualizations and has some nice talks that I think you can find on YouTube!\n\n## `patchwork`\n\nI mention this package separately as well. `patchwork` allows you to combine different plots created with `ggplot2`. This package should be installed on it's own.\n\n## `tidybayes`\n\nThis package is a dedicated package to make use of the <b>tidy</b> principles when applying it to (results of) Bayesian analyses.\n\n## `bayesplot`\n\nWe will use visualisations a lot in Bayesian analyses to summarize the information of models and parameter estimation. `bayesplot` bundles a number of functions that make this visualizing much easier (although it uses `ggplot2` under the hood so we could accomplish similar results just knowing `ggplot2`).\n\n# Coding in the tidy universe...\n\nThere are a great number of roads that will lead to Rome! Coding in R can be accomplished in several ways. This means that code can get messy as well! Therefore, I try to keep myself as much as possible to some rules that are described by what is called the <b>tidy</b> way of coding. Some basic things are key to this approach. I will shortly describe them here so you will recognize this way of working when we're in the workshop. \n\n## The pipe\n\nWhen coding I make use of what is called <b>the pipe operator</b> (notice that you can only use this when you loaded the `tidyverse` package).\n\nThe pipe in R code is the following: ```%>%```\n\nWhat is nice about using the pipe operator is that you can read a piece of code from left to right focussing on the verbs (as Hadley Wickham will call it sometimes).\n\nA short example. \n\nImagine you have a vector of numbers for which you want to calculate a mean: ```c(1,2,3,4,5)```.\n\nThere are different ways to do this in R. \n\nA first one is doing it in separate lines of code:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(1,2,3,4,5)\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n:::\n\n\n\n\nFor this easy example this would work fine. But a typical side-effect of working this way is that we create a lot of objects along the way. Here we created the object `x` that stored the values of the vector.\n\nTo avoid this we could combine all the code in one line by embedding functions:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(c(1,2,3,4,5))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n:::\n\n\n\n\nOne line of code and no storage of a new object. But this can get complicated if you want to combine a set of functions resulting in almost non-readable code! \n\nThen there is the pipe operator:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nc(1,2,3,4,5) %>%\n  mean()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n:::\n\n\n\n\nThis is how to read this code:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc(1,2,3,4,5) %>% # create the vector and then\n  mean()         # calculate the mean\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n:::\n\n\n\n\nSo the pipe can be read as `take (or create) A` and `then do B` with the result. We could create a whole pipeline of functions to be applied in this way making use of the pipe operator (this becomes more clear in the next section when we shortly describe the `dplyr` verbs).\n\nA tweet that I encountered gives a great analogy. Using the pipe you could write:\n\n> I %>% woke up %>% took a shower %>% got breakfast %>% took the metro %>% arrived at work %>% ...\n\nIn a recent update of `R` they also introduced this idea of a pipe as a \"native pipe\". This is written as `|>` and functions in a similar way as `%>%` with the advantage that it will also work outside the `tidyverse`. I'm slowly transforming all my material and code to make use of this native pipe. But as I am notoriously sloppy, the chances are high that you will encounter some old-fashioned tidyverse pipes in my code during the workshop...\n\n> I |> learned about the native pipe |> transformed my code |> potentially failed somewhere ...\n\n## `dplyr` verbs\n\nWithin the `tidyverse` universe we can make use of a great package called `dplyr` for a broad spectrum of data-management functions. The functions provided in that package are also sometimes called <b>verbs</b>:\n\n- `mutate( )` to do recoding etc;\n- `select( )` to select a subset of columns/variables;\n- `filter( )` to filter cases;\n- `group_by( )` to apply what's coming afterwards for specific groups in the data by a grouping variable;\n- `arrange( )` to sort the data;\n- `summarize( )` to apply summarizing functions (like taking the mean etc.);\n- `rename( )` to rename columns;\n\nThese functions can be combined in a single statement making use of the pipe operator. \n\nHere are some examples on the use of these verbs applied to the built-in dataset `starwars` that is part of the `tidyverse` package.\n\nCalculate the mean `birth_year` for all the characters:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars |> \n  summarize(\n    mean_birth_year = mean(birth_year, na.rm = TRUE)\n    ) |>\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  mean_birth_year\n            <dbl>\n1            87.6\n```\n\n\n:::\n:::\n\n\n\n\nCalculate the average height and the average mass by gender:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars |>\n  group_by(gender) |>\n  summarize(\n    mean_height = mean(height, na.rm = T),\n    mean_mass = mean(mass, na.rm = T)\n  ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  gender    mean_height mean_mass\n  <chr>           <dbl>     <dbl>\n1 feminine         167.      54.7\n2 masculine        177.     107. \n3 <NA>             175       81  \n```\n\n\n:::\n:::\n\n\n\n\nNow, let's use the verbs to create a graph. We want to create a scatterplot with mass on the x-axis and height on the y-axis. Also, we want to add a third variable in the mix: whether the character's birth year is hither than 50 or not (just for fun). Finally, we only want to show characters that have a mass lower than 200 and with a birth_year that is known.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars |>\n  # First filter the cases with a mass higher than 200 and for which birth_year is not NA\n  filter(\n    mass < 200,\n    !is.na(birth_year)\n  ) |>\n\n  # Then we create a variable that has value yes if the character's birth year is above 50 and no otherwise\n  mutate(\n    birth_above_50 = if_else(birth_year > 50, \"yes\", \"no\") \n  ) |>\n  \n  # Select the necessary variables for the graph (not really necessary but this is to show this option)\n  select(\n    height, \n    mass, \n    birth_above_50) |>\n\n  # Create the graph\n  ggplot(\n    aes(x = mass, y = height, color = birth_above_50)\n  ) + geom_point()\n```\n\n::: {.cell-output-display}\n![](Prerequisites_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Prerequisites_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}